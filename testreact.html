<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }

        .video-progress {
            touch-action: none;
            user-select: none;
        }

        .playhead {
            transition: transform 0.1s ease-out;
        }

        .playhead:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div id="root" class="w-full max-w-2xl"></div>

    <script type="text/babel">
        const VideoPlayer = () => {
            const videoRef = React.useRef(null);
            const progressRef = React.useRef(null);
            const [progress, setProgress] = React.useState(0);
            const [duration, setDuration] = React.useState(0);
            const [isDragging, setIsDragging] = React.useState(false);

            React.useEffect(() => {
                if (videoRef.current) {
                    setDuration(videoRef.current.duration);
                }
            }, [videoRef.current]);

            const handleTimeUpdate = () => {
                if (!isDragging && videoRef.current) {
                    const progress = (videoRef.current.currentTime / videoRef.current.duration) * 100;
                    setProgress(progress);
                }
            };

            const handleSeek = (e) => {
                if (videoRef.current && progressRef.current) {
                    const rect = progressRef.current.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const percentage = Math.max(0, Math.min(100, (x / rect.width) * 100));
                    const seekTime = (percentage / 100) * videoRef.current.duration;
                    videoRef.current.currentTime = seekTime;
                    setProgress(percentage);
                }
            };

            const handleTouchMove = (e) => {
                if (isDragging && progressRef.current && e.touches[0]) {
                    const rect = progressRef.current.getBoundingClientRect();
                    const x = e.touches[0].clientX - rect.left;
                    const percentage = Math.max(0, Math.min(100, (x / rect.width) * 100));
                    const seekTime = (percentage / 100) * videoRef.current.duration;
                    videoRef.current.currentTime = seekTime;
                    setProgress(percentage);
                }
            };

            const formatTime = (time) => {
                const minutes = Math.floor(time / 60);
                const seconds = Math.floor(time % 60);
                return `${minutes}:${seconds.toString().padStart(2, '0')}`;
            };

            return (
                <div className="w-full max-w-2xl mx-auto p-4">
                    <div className="relative">
                        <video
                            ref={videoRef}
                            className="w-full rounded-lg"
                            src="https://raw.githubusercontent.com/cameocreative2019/IVFForm/refs/heads/main/embryo.mp4"
                            onTimeUpdate={handleTimeUpdate}
                            onLoadedMetadata={(e) => setDuration(e.target.duration)}
                            controls={false}
                            playsInline
                        />

                        <div className="mt-4">
                            <div
                                ref={progressRef}
                                className="relative h-12 group touch-none video-progress"
                                onClick={handleSeek}
                                onTouchMove={handleTouchMove}
                                onTouchStart={() => setIsDragging(true)}
                                onTouchEnd={() => setIsDragging(false)}
                                onMouseDown={() => setIsDragging(true)}
                                onMouseUp={() => setIsDragging(false)}
                                onMouseLeave={() => setIsDragging(false)}
                            >
                                {/* Progress bar background */}
                                <div className="absolute top-5 left-0 w-full h-2 bg-gray-200 rounded-full" />

                                {/* Blue progress indicator */}
                                <div
                                    className="absolute top-5 left-0 h-2 bg-blue-500 rounded-full"
                                    style={{ width: `${progress}%` }}
                                />

                                {/* Large draggable playhead */}
                                <div
                                    className="playhead absolute top-2 h-8 w-8 bg-blue-500 rounded-full shadow-lg cursor-grab active:cursor-grabbing transform -translate-x-1/2"
                                    style={{ left: `${progress}%` }}
                                />
                            </div>

                            {/* Time display */}
                            <div className="text-sm text-gray-600 mt-2">
                                {formatTime(videoRef.current?.currentTime || 0)} / {formatTime(duration)}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Render the component
        ReactDOM.render(<VideoPlayer />, document.getElementById('root'));
    </script>
</body>
</html>